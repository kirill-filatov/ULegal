<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Domestic Duty Calculator (USA zones)</title>
<style>
:root{
  --card:#ffffff;--bg:#f7f8fa;--accent:#fcb900;--muted:#666;
  --panel:#eef4ff;--panel-border:#c5d8ff;--input-bg:#f9f9f9;
}
html,body{height:100%;margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg)}
.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px}
.card{width:480px;background:var(--card);padding:24px;border-radius:12px;
      box-shadow:0 10px 30px rgba(0,0,0,0.08)}
.title{background:var(--accent);padding:10px;border-radius:8px;text-align:center;
       font-weight:700;margin-bottom:18px}
.row{display:flex;align-items:center;gap:10px;margin-bottom:12px}
.label{width:160px;font-weight:700;color:#222}
.control{flex:1;display:flex;align-items:center;gap:8px}
input[type="number"],select{padding:8px;border-radius:8px;border:1px solid #d0d0d0;
                            background:var(--input-bg);font-size:15px;width:70px;}
.inline-inputs{display:flex;gap:6px;align-items:center}
.inline-inputs input[type="number"]{width:60px}
.output{background:var(--panel);border:1px solid var(--panel-border);padding:8px;
        border-radius:8px;font-weight:700}
.note,footer{text-align:center;font-size:12px;color:var(--muted);margin-top:10px}
footer{margin-top:16px;font-weight:600}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="title">Domestic ONLY</div>

    <!-- Report Time -->
    <div class="row">
      <div class="label">Report Time</div>
      <div class="control inline-inputs">
        <input id="reportHour" type="number" min="0" max="23" placeholder="HH" />
        <input id="reportMin" type="number" min="0" max="59" placeholder="MM" />
        <select id="reportTz" class="tz-select">
          <option data-offset="-300">Eastern (UTC-05:00)</option>
          <option data-offset="-360">Central (UTC-06:00)</option>
          <option data-offset="-420">Mountain (UTC-07:00)</option>
          <option data-offset="-480">Pacific (UTC-08:00)</option>
          <option data-offset="-540">Alaska (UTC-09:00)</option>
          <option data-offset="-600">Hawaii (UTC-10:00)</option>
        </select>
      </div>
    </div>

    <!-- Scheduled Duty -->
    <div class="row">
      <div class="label">Scheduled Duty</div>
      <div class="control inline-inputs">
        <input id="dutyHours" type="number" min="0" max="23" placeholder="Hours" />
        <input id="dutyMins" type="number" min="0" max="59" placeholder="Minutes" />
        <select id="dutyTz" class="tz-select">
          <option data-offset="-300">Eastern (UTC-05:00)</option>
          <option data-offset="-360">Central (UTC-06:00)</option>
          <option data-offset="-420">Mountain (UTC-07:00)</option>
          <option data-offset="-480">Pacific (UTC-08:00)</option>
          <option data-offset="-540">Alaska (UTC-09:00)</option>
          <option data-offset="-600">Hawaii (UTC-10:00)</option>
        </select>
      </div>
    </div>

    <!-- Scheduled Block -->
    <div class="row">
      <div class="label">Scheduled Block</div>
      <div class="control inline-inputs">
        <input id="blockHours" type="number" min="0" max="23" placeholder="Hours" />
        <input id="blockMins" type="number" min="0" max="59" placeholder="Minutes" />
      </div>
    </div>

    <!-- Time Difference -->
    <div class="row">
      <div class="label">Time Difference</div>
      <div class="control"><div id="timeDifference" class="output">—</div></div>
    </div>

    <!-- Scheduled Departure -->
    <div class="row">
      <div class="label">Scheduled Departure</div>
      <div class="control inline-inputs">
        <input id="depHour" type="number" min="0" max="23" placeholder="HH" />
        <input id="depMin" type="number" min="0" max="59" placeholder="MM" />
        <select id="departTz" class="tz-select">
          <option data-offset="-300">Eastern (UTC-05:00)</option>
          <option data-offset="-360">Central (UTC-06:00)</option>
          <option data-offset="-420">Mountain (UTC-07:00)</option>
          <option data-offset="-480">Pacific (UTC-08:00)</option>
          <option data-offset="-540">Alaska (UTC-09:00)</option>
          <option data-offset="-600">Hawaii (UTC-10:00)</option>
        </select>
      </div>
    </div>

    <!-- Door Closed -->
    <div class="row">
      <div class="label">Door Closed</div>
      <div class="control"><div id="doorClosed" class="output">—</div></div>
    </div>

    <div class="note">All times use 24-hour (military) format.</div>
    <footer>Version 6</footer>
  </div>
</div>

<script>
// Parse HH/MM inputs to minutes
function parseHMInputs(hourEl, minEl){ 
  const h=parseInt(hourEl.value,10); 
  const m=parseInt(minEl.value,10); 
  if(isNaN(h)&&isNaN(m)) return null; 
  return (isNaN(h)?0:h)*60 + (isNaN(m)?0:m); 
}

// Clamp value to 0–max and max 2 digits
function clampInput(el, max){
  el.addEventListener('input',()=>{
    if(el.value.length>2) el.value = el.value.slice(0,2);
    let v = parseInt(el.value,10);
    if(!isNaN(v)){
      if(v>max) el.value = max;
      if(v<0) el.value = 0;
    }
  });
}

// Apply to all numeric fields
['reportHour','reportMin','dutyHours','dutyMins','blockHours','blockMins','depHour','depMin'].forEach(id=>{
  clampInput(document.getElementById(id), id.includes('Hour')?23:59);
});

// Minutes → HH:MM string
function minutesToHHMM(mins){
  if(mins==null) return '—';
  mins=((mins%1440)+1440)%1440;
  const h=String(Math.floor(mins/60)).padStart(2,'0');
  const m=String(mins%60).padStart(2,'0');
  return `${h}:${m}`;
}

// Duration formatting
function formatDuration(mins){
  if(mins==null) return '—';
  const h=Math.floor(mins/60);
  const m=mins%60;
  return `${h}h ${m}m`;
}

function getOffset(el){return Number(el.selectedOptions[0].dataset.offset||0);}

// Elements
const reportHour=document.getElementById('reportHour');
const reportMin=document.getElementById('reportMin');
const reportTz=document.getElementById('reportTz');
const dutyHours=document.getElementById('dutyHours');
const dutyMins=document.getElementById('dutyMins');
const dutyTz=document.getElementById('dutyTz');
const depHour=document.getElementById('depHour');
const depMin=document.getElementById('depMin');
const depTz=document.getElementById('departTz');
const diffEl=document.getElementById('timeDifference');
const doorEl=document.getElementById('doorClosed');

function update(){
  const r=parseHMInputs(reportHour,reportMin);
  const d=parseHMInputs(dutyHours,dutyMins);
  const dep=parseHMInputs(depHour,depMin);
  if(r==null||d==null){diffEl.textContent='—'; doorEl.textContent='—'; return;}

  // Convert all to UTC
  const reportUTC = r - getOffset(reportTz);
  const dutyUTC = d; // Scheduled duty is duration, not absolute time
  const anchor = (r>=300 && r<=1139)?900:780; // 15:00/13:00
  let td = anchor - d;
  if(td<0) td+=1440;
  diffEl.textContent = formatDuration(td);

  if(dep!=null){
    const depUTC = dep - getOffset(depTz);
    const doorUTC = depUTC + td;
    const localDoor = doorUTC + getOffset(depTz);
    doorEl.textContent = minutesToHHMM(localDoor);
  } else {doorEl.textContent='—';}
}

// Add event listeners
[reportHour,reportMin,reportTz,dutyHours,dutyMins,dutyTz,depHour,depMin,depTz]
  .forEach(el=>el.addEventListener('input',update));
</script>
</body>
</html>
